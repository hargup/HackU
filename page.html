<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Keyboard</title>
  </head>
  <body>
    <ul id="mods"></ul>
    <div id="bind"></div>
    <textarea></textarea>
    <script src="Keyboard.js"></script>

<script>
var keyboard = new Keyboard(window);

var text="";

var modifiers = {
  Alt: 'Alt',
  Shift: 'Shift',
  Control:'Control',
  MetaLeft: 'Meta',
  MetaRight: 'Meta',
};

var names = {};

var cursorPos = 0;
var insertMode = false;
var replaceMode = false;
var navigationKeys = {
	up:"k",
	down:"j",
	left:"l",
	right:"h"
},

var area=document.getElementsByTagName("textarea")[0];

Object.keys(modifiers).forEach(function(key){
  var mod = modifiers[key];
  if (mod in names) {
    modifiers[key] = names[mod];
  } else {
    var el = names[mod] = modifiers[key] = document.createElement('li');
    el.textContent = mod;
    text=text+mod;
    area.value=text;
    el.id = mod;
    mods.appendChild(el);
  }
});


var engaged = {};



keyboard.on('*', function(e){
  if (e.action === 'activate') {
    if (e.name in modifiers) {
      modifiers[e.name].className = 'active';
    } else {
      engaged[e.name] = true;
      bind.textContent = Object.keys(engaged).join(' - ');
      text=text+Object.keys(engaged);
      area.value=text;
    }
  } else if (e.action === 'release') {
    if (e.name in modifiers) {
      modifiers[e.name].className = '';
    } else {
      delete engaged[e.name];
      bind.textContent = Object.keys(engaged).join(' Â· ');
    }
  }
});

window.addEventListener('blur', function(e){
  engaged = {};
  bind.textContent = '';
  for (var k in modifiers) {
    modifiers[k].className = '';
  }
});
</script>
  </body>
</html>
