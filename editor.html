<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Keyboard</title>
  </head>
  <body>
    <ul id="mods"></ul>
    <div id="bind"></div>
    <textarea></textarea>
    <script src="Keyboard.js"></script>


<script>
var keyboard = new Keyboard(window);

var modifiers = {
  Alt: 'Alt',
  Shift: 'Shift',
  Control:'Control',
  MetaLeft: 'Meta',
  MetaRight: 'Meta',
};

var names = {};
var text = "";
var keyPressed = "";
var area=document.getElementsByTagName("textarea")[0];
var insertMode = false;
var insertKeys = ["I"];
var navigationKeys = {
	up:"k",
	down:"j",
	left:"h",
	right:"l"
};


var engaged = {};

keyboard.on('*', function(e){
  if (e.action === 'activate') {
    if (e.name in modifiers) {
      modifiers[e.name].className = 'active';
    } else {
      engaged[e.name] = true;
      keyPressed = Object.keys(engaged);
      if(insertMode === false ) 
      {
	      console.log(insertKeys);
	      console.log(keyPressed);
	      if(keyPressed[0] === insertKeys[0])
	      {
	      insertMode = true;
	      console.log("InsertKeys" + keyPressed);
      }
}
	else
	{
	keyboard.on( "Ctrl+C" , "activate" , function(e){ insertMode = false ;});
        keyboard.on( "Escape" , "activate" , function(e){ insertMode = false ;});

	if(keyPressed.length == 1 && keyPressed[0] == "Ecape")
	{
		insertMode = false;
	}
	else
	{
      text=text+keyPressed;
      area.value=text;
      }
      }

    }
  } else if (e.action === 'release') {
    if (e.name in modifiers) {
      modifiers[e.name].className = '';
    } else {
      delete engaged[e.name];
      bind.textContent = Object.keys(engaged).join(' Â· ');
    }
  }
});

window.addEventListener('blur', function(e){
  engaged = {};
  bind.textContent = '';
  for (var k in modifiers) {
    modifiers[k].className = '';
  }
});
</script>
  </body>
</html>
