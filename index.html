<!DOCTYPE html>
	<head>
		<title> Hello World! Hi Vi-Text!</title>
		<script src="Keyboard.js" type="text/javascript"></script> 
    	<script src="bindings.js" type="text/javascript"></script> 
	</head>
	<body>
		
		<textarea id="hello" cols=30> Hello my name is Vivek Rai. ! </textarea>
		<textarea id="hello1"> Hello my name is Vivek Rai. ! </textarea>
		<textarea id="hello2"> Hello my name is Vivek Rai. ! </textarea>
	</body>
	<script>
		var e = document.getElementsByTagName('textarea');
		for (var i=0;i<e.length;i++)
			e[i].setAttribute('onkeypress','return captureKeys(event);')

	</script>
<script>
	var insertMode = new Boolean(); //Default false value!
	var replaceMode = false;
	var ReplaceMode = false;
	
	var del = function(area, pos){
	text = area.value;
	var before = text.slice(0, pos);
	var after = text.slice(pos + 1);
	text = before + after;
	area.value = text ;
	setCaretPosition(area, pos);
	};

	var append = function(area, character, pos);

	insertMode = false;
	function captureKeys (event){
            var chCode = event.which || event.keyCode;
            if (chCode == 0)
            	chCode = event.keyCode; 
/////// Event for handling EDIT Mode
            if (chCode==105 && insertMode != true) {
		if(replaceMode != true){
            	insertMode = !insertMode;
		return false;
		}
            }

            else if (insertMode == true && chCode!=27){
            	console.log('yes1');
            		//console.log(toReturn);
            	return (chCode);
            } else if (chCode==27) {
            	insertMode = false;
		return false;
            }
            else {
            	var iD = document.activeElement.id;
            	var area = document.getElementById(iD);
            	var pos = doGetCaretPosition(area);
		if (chCode == 114) { console.log("replace mode enter");
		//	del(area, pos);
		};
		if (chCode == 120) { console.log(pos);
			del(area, pos);
		console.log(text);
		};
            	if (chCode == 104) { console.log(pos);
            		setCaretPosition(area, pos-1);
					};
				if (chCode == 106) {//var pos = doGetCaretPosition(area);
            		setCaretPosition(area, pos+area.cols);
            		//console.log(pos); console.log(area.cols)
            		};
				if (chCode == 107) {//var pos = doGetCaretPosition(area);
					//console.log
            		setCaretPosition(area, pos-area.cols);
            		//console.log(pos);
            		};
				if (chCode == 108) //var pos = doGetCaretPosition(area);
            		setCaretPosition(area, pos+1);
            		}

            return false;
            }
///////////////////////////////////////////

function doGetCaretPosition (ctrl) {
	var CaretPos = 0;	// IE Support
	if (document.selection) {
	ctrl.focus ();
		var Sel = document.selection.createRange ();
		Sel.moveStart ('character', -ctrl.value.length);
		CaretPos = Sel.text.length;
	}
	// Firefox support
	else if (ctrl.selectionStart || ctrl.selectionStart == '0')
		CaretPos = ctrl.selectionStart;
	return (CaretPos);
}
function setCaretPosition(ctrl, pos){
	if(ctrl.setSelectionRange)
	{
		ctrl.focus();
		ctrl.setSelectionRange(pos,pos);
	}
	else if (ctrl.createTextRange) {
		var range = ctrl.createTextRange();
		range.collapse(true);
		range.moveEnd('character', pos);
		range.moveStart('character', pos);
		range.select();
	}
}

	</script>
</html>
